
. 
. *ignore the below line (and whenever you see "pause"). This is for me 
. pause on

. 
. 
.   summarize male frlunch black white hispanic asian 

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
        male |      2,727    .4979831    .5000876          0          1
     frlunch |      2,749    .6173154    .4861307          0          1
       black |      2,727    .3370004    .4727717          0          1
       white |      2,727    .3681702    .4823963          0          1
    hispanic |      2,727    .2486249    .4322951          0          1
-------------+---------------------------------------------------------
       asian |      2,727    .0201687    .1406028          0          1

.   *can you interpret the averages?
. pause 
pause:  
-> . q
execution resumes...

.   * On average, what is the difference in scores for those who got tuition vs those who didn't get tu
> ition?
. pause
pause:  
-> . q
execution resumes...

.   summarize score_endyr if treat==1, d

         (outcome var.) math test score: end of year
-------------------------------------------------------------
      Percentiles      Smallest
 1%          188            178
 5%          199            180
10%          204            180       Obs               1,295
25%          212            182       Sum of wgt.       1,295

50%          220                      Mean           218.7243
                        Largest       Std. dev.      11.38509
75%          226            251
90%          233            251       Variance       129.6202
95%          236            253       Skewness      -.3299872
99%          244            260       Kurtosis       3.478121

.   summarize score_endyr if treat==0, d

         (outcome var.) math test score: end of year
-------------------------------------------------------------
      Percentiles      Smallest
 1%          197            176
 5%          206            181
10%          211            182       Obs               1,472
25%          218            185       Sum of wgt.       1,472

50%          226                      Mean           225.9158
                        Largest       Std. dev.      12.37494
75%          234            270
90%          242            272       Variance       153.1391
95%          246            274       Skewness       .1214666
99%          257            275       Kurtosis       3.763762

.   ttest score_endyr, by(treat)

Two-sample t test with equal variances
------------------------------------------------------------------------------
   Group |     Obs        Mean    Std. err.   Std. dev.   [95% conf. interval]
---------+--------------------------------------------------------------------
       0 |   1,472    225.9158    .3225441    12.37494    225.2831    226.5485
       1 |   1,295    218.7243    .3163745    11.38509    218.1037     219.345
---------+--------------------------------------------------------------------
Combined |   2,767    222.5501    .2366508    12.44837     222.086    223.0141
---------+--------------------------------------------------------------------
    diff |            7.191437    .4542159                  6.3008    8.082073
------------------------------------------------------------------------------
    diff = mean(0) - mean(1)                                      t =  15.8326
H0: diff = 0                                     Degrees of freedom =     2765

    Ha: diff < 0                 Ha: diff != 0                 Ha: diff > 0
 Pr(T < t) = 1.0000         Pr(|T| > |t|) = 0.0000          Pr(T > t) = 0.0000

.   *is this difference, the causal effect of tuition? Why? Why not?
. pause 
pause:  
-> . q
execution resumes...

. 
. * graphical analysis: best place to start with rd designs
.   twoway (scatter score_endyr score_startyr if score_startyr < 215, mcolor(%50)) ///
>   (scatter score_endyr score_startyr if score_startyr >= 215, mcolor(%50)) ///
>   , xline(215) legend(off)

.   
.   *using only information on screen, what quantity on the screen gives us the causal effect?
.   pause
pause:  
-> . q
execution resumes...

.   
.   reg score_endyr score_startyr treat

      Source |       SS           df       MS      Number of obs   =     2,767
-------------+----------------------------------   F(2, 2764)      =    966.73
       Model |  176420.833         2  88210.4164   Prob > F        =    0.0000
    Residual |  252203.985     2,764  91.2460147   R-squared       =    0.4116
-------------+----------------------------------   Adj R-squared   =    0.4112
       Total |  428624.817     2,766  154.961973   Root MSE        =    9.5523

-------------------------------------------------------------------------------
  score_endyr | Coefficient  Std. err.      t    P>|t|     [95% conf. interval]
--------------+----------------------------------------------------------------
score_startyr |   .8946397   .0227754    39.28   0.000     .8499812    .9392982
        treat |   10.96764   .5883512    18.64   0.000     9.813988    12.12129
        _cons |   24.74034   5.127495     4.83   0.000     14.68624    34.79445
-------------------------------------------------------------------------------

.   *verify
.   pause 
pause:  
-> . q
execution resumes...

.   
.   reg score_endyr treat score_startyr 

      Source |       SS           df       MS      Number of obs   =     2,767
-------------+----------------------------------   F(2, 2764)      =    966.73
       Model |  176420.833         2  88210.4164   Prob > F        =    0.0000
    Residual |  252203.985     2,764  91.2460147   R-squared       =    0.4116
-------------+----------------------------------   Adj R-squared   =    0.4112
       Total |  428624.817     2,766  154.961973   Root MSE        =    9.5523

-------------------------------------------------------------------------------
  score_endyr | Coefficient  Std. err.      t    P>|t|     [95% conf. interval]
--------------+----------------------------------------------------------------
        treat |   10.96764   .5883512    18.64   0.000     9.813988    12.12129
score_startyr |   .8946397   .0227754    39.28   0.000     .8499812    .9392982
        _cons |   24.74034   5.127495     4.83   0.000     14.68624    34.79445
-------------------------------------------------------------------------------

.   predict yhat 
(option xb assumed; fitted values)

.   twoway scatter score_endyr score_startyr || scatter yhat score_startyr, msize(medium) legend(off)

.   
. * balancing tests to check "quasi-randomisation"
. 
.   ttest age, by(treat)

Two-sample t test with equal variances
------------------------------------------------------------------------------
   Group |     Obs        Mean    Std. err.   Std. dev.   [95% conf. interval]
---------+--------------------------------------------------------------------
       0 |   1,449    12.63559     .014213    .5410278    12.60771    12.66347
       1 |   1,274    12.76421    .0177843    .6347787    12.72932     12.7991
---------+--------------------------------------------------------------------
Combined |   2,723    12.69577    .0113094    .5901494    12.67359    12.71794
---------+--------------------------------------------------------------------
    diff |           -.1286171    .0225353                -.172805   -.0844291
------------------------------------------------------------------------------
    diff = mean(0) - mean(1)                                      t =  -5.7074
H0: diff = 0                                     Degrees of freedom =     2721

    Ha: diff < 0                 Ha: diff != 0                 Ha: diff > 0
 Pr(T < t) = 0.0000         Pr(|T| > |t|) = 0.0000          Pr(T > t) = 1.0000

.   ttest age if (score_startyr>=213 & score_startyr<=217), by(treat)

Two-sample t test with equal variances
------------------------------------------------------------------------------
   Group |     Obs        Mean    Std. err.   Std. dev.   [95% conf. interval]
---------+--------------------------------------------------------------------
       0 |     281    12.70922    .0352393    .5907185    12.63985    12.77859
       1 |     170    12.67649    .0474661    .6188821    12.58279    12.77019
---------+--------------------------------------------------------------------
Combined |     451    12.69688    .0283007     .601015    12.64127     12.7525
---------+--------------------------------------------------------------------
    diff |            .0327296    .0584423               -.0821248    .1475841
------------------------------------------------------------------------------
    diff = mean(0) - mean(1)                                      t =   0.5600
H0: diff = 0                                     Degrees of freedom =      449

    Ha: diff < 0                 Ha: diff != 0                 Ha: diff > 0
 Pr(T < t) = 0.7121         Pr(|T| > |t|) = 0.5757          Pr(T > t) = 0.2879

.   
.   ttest male, by(treat)

Two-sample t test with equal variances
------------------------------------------------------------------------------
   Group |     Obs        Mean    Std. err.   Std. dev.   [95% conf. interval]
---------+--------------------------------------------------------------------
       0 |   1,451    .5279118    .0131102    .4993924    .5021949    .5536287
       1 |   1,276    .4639498    .0139664    .4988942    .4365503    .4913494
---------+--------------------------------------------------------------------
Combined |   2,727    .4979831    .0095764    .5000876    .4792053    .5167609
---------+--------------------------------------------------------------------
    diff |            .0639619    .0191568                .0263986    .1015252
------------------------------------------------------------------------------
    diff = mean(0) - mean(1)                                      t =   3.3389
H0: diff = 0                                     Degrees of freedom =     2725

    Ha: diff < 0                 Ha: diff != 0                 Ha: diff > 0
 Pr(T < t) = 0.9996         Pr(|T| > |t|) = 0.0009          Pr(T > t) = 0.0004

.   ttest male if (score_startyr>=213 & score_startyr<=217), by(treat)

Two-sample t test with equal variances
------------------------------------------------------------------------------
   Group |     Obs        Mean    Std. err.   Std. dev.   [95% conf. interval]
---------+--------------------------------------------------------------------
       0 |     282    .4680851    .0297667    .4998675    .4094911    .5266791
       1 |     170    .4588235    .0383309    .4997737    .3831545    .5344926
---------+--------------------------------------------------------------------
Combined |     452    .4646018     .023485     .499298    .4184482    .5107554
---------+--------------------------------------------------------------------
    diff |            .0092616    .0485338               -.0861195    .1046427
------------------------------------------------------------------------------
    diff = mean(0) - mean(1)                                      t =   0.1908
H0: diff = 0                                     Degrees of freedom =      450

    Ha: diff < 0                 Ha: diff != 0                 Ha: diff > 0
 Pr(T < t) = 0.5756         Pr(|T| > |t|) = 0.8487          Pr(T > t) = 0.4244

.  
.   ttest frlunch, by(treat)

Two-sample t test with equal variances
------------------------------------------------------------------------------
   Group |     Obs        Mean    Std. err.   Std. dev.   [95% conf. interval]
---------+--------------------------------------------------------------------
       0 |   1,463    .5399863    .0130348     .498569    .5144175    .5655552
       1 |   1,286    .7052877    .0127183    .4560907    .6803367    .7302387
---------+--------------------------------------------------------------------
Combined |   2,749    .6173154    .0092718    .4861307    .5991349    .6354959
---------+--------------------------------------------------------------------
    diff |           -.1653014    .0183161                -.201216   -.1293868
------------------------------------------------------------------------------
    diff = mean(0) - mean(1)                                      t =  -9.0249
H0: diff = 0                                     Degrees of freedom =     2747

    Ha: diff < 0                 Ha: diff != 0                 Ha: diff > 0
 Pr(T < t) = 0.0000         Pr(|T| > |t|) = 0.0000          Pr(T > t) = 1.0000

.   ttest frlunch if (score_startyr>=213 & score_startyr<=217), by(treat)

Two-sample t test with equal variances
------------------------------------------------------------------------------
   Group |     Obs        Mean    Std. err.   Std. dev.   [95% conf. interval]
---------+--------------------------------------------------------------------
       0 |     287    .6202091    .0286984    .4861825    .5637221     .676696
       1 |     172    .6744186    .0358341    .4699598    .6036845    .7451528
---------+--------------------------------------------------------------------
Combined |     459    .6405229    .0224218    .4803708    .5964605    .6845852
---------+--------------------------------------------------------------------
    diff |           -.0542095    .0463022               -.1452013    .0367822
------------------------------------------------------------------------------
    diff = mean(0) - mean(1)                                      t =  -1.1708
H0: diff = 0                                     Degrees of freedom =      457

    Ha: diff < 0                 Ha: diff != 0                 Ha: diff > 0
 Pr(T < t) = 0.1211         Pr(|T| > |t|) = 0.2423          Pr(T > t) = 0.8789

.   
.   ttest white, by(treat)

Two-sample t test with equal variances
------------------------------------------------------------------------------
   Group |     Obs        Mean    Std. err.   Std. dev.   [95% conf. interval]
---------+--------------------------------------------------------------------
       0 |   1,451    .4362509    .0130235    .4960904     .410704    .4617977
       1 |   1,276    .2907524    .0127176    .4542875    .2658026    .3157021
---------+--------------------------------------------------------------------
Combined |   2,727    .3681702    .0092376    .4823963    .3500566    .3862837
---------+--------------------------------------------------------------------
    diff |            .1454985    .0183059                .1096037    .1813933
------------------------------------------------------------------------------
    diff = mean(0) - mean(1)                                      t =   7.9482
H0: diff = 0                                     Degrees of freedom =     2725

    Ha: diff < 0                 Ha: diff != 0                 Ha: diff > 0
 Pr(T < t) = 1.0000         Pr(|T| > |t|) = 0.0000          Pr(T > t) = 0.0000

.   ttest white if (score_startyr>=213 & score_startyr<=217), by(treat)

Two-sample t test with equal variances
------------------------------------------------------------------------------
   Group |     Obs        Mean    Std. err.   Std. dev.   [95% conf. interval]
---------+--------------------------------------------------------------------
       0 |     282    .3510638    .0284735    .4781514    .2950154    .4071123
       1 |     170    .3882353    .0374884    .4887883    .3142295    .4622411
---------+--------------------------------------------------------------------
Combined |     452    .3650442    .0226702     .481976    .3204918    .4095967
---------+--------------------------------------------------------------------
    diff |           -.0371715    .0468192               -.1291828    .0548399
------------------------------------------------------------------------------
    diff = mean(0) - mean(1)                                      t =  -0.7939
H0: diff = 0                                     Degrees of freedom =      450

    Ha: diff < 0                 Ha: diff != 0                 Ha: diff > 0
 Pr(T < t) = 0.2138         Pr(|T| > |t|) = 0.4277          Pr(T > t) = 0.7862

.   
. * local regression techniques: exploratory analysis 
.   
.   twoway scatter score_endyr score_startyr if score_startyr<215, xline(215) ///
>   msymbol(Oh) msize(vsmall) || scatter score_endyr score_startyr ///
>   if score_startyr>=215, xline(215) msymbol(O) msize(vsmall) ///
>   || lowess score_endyr score_startyr if score_startyr<215 ///
>   || lowess score_endyr score_startyr if score_startyr>=215 

.   
. * placebo analysis 1: 210 cut-off
.   twoway scatter score_endyr score_startyr if score_startyr<210, xline(210) ///
>   msymbol(Oh) msize(vsmall) || scatter score_endyr score_startyr ///
>   if score_startyr>=210, xline(210) msymbol(O) msize(vsmall) ///
>   || lowess score_endyr score_startyr if score_startyr<210 ///
>   || lowess score_endyr score_startyr if score_startyr>=210 

.  
. * placebo analysis 2: 220 cut-off
.   twoway scatter score_endyr score_startyr if score_startyr<220, xline(220) ///
>   msymbol(Oh) msize(vsmall) || scatter score_endyr score_startyr ///
>   if score_startyr>=220, xline(220) msymbol(O) msize(vsmall) ///
>   || lowess score_endyr score_startyr if score_startyr<220 ///
>   || lowess score_endyr score_startyr if score_startyr>=220 

. 
. * fitting a regression to data: 
.   reg score_endyr treat score_startyr 

      Source |       SS           df       MS      Number of obs   =     2,767
-------------+----------------------------------   F(2, 2764)      =    966.73
       Model |  176420.833         2  88210.4164   Prob > F        =    0.0000
    Residual |  252203.985     2,764  91.2460147   R-squared       =    0.4116
-------------+----------------------------------   Adj R-squared   =    0.4112
       Total |  428624.817     2,766  154.961973   Root MSE        =    9.5523

-------------------------------------------------------------------------------
  score_endyr | Coefficient  Std. err.      t    P>|t|     [95% conf. interval]
--------------+----------------------------------------------------------------
        treat |   10.96764   .5883512    18.64   0.000     9.813988    12.12129
score_startyr |   .8946397   .0227754    39.28   0.000     .8499812    .9392982
        _cons |   24.74034   5.127495     4.83   0.000     14.68624    34.79445
-------------------------------------------------------------------------------

.   predict yhat 
variable yhat already defined
r(110);

end of do-file

r(110);

. do "C:\Users\u1972955\Dropbox\TA\EC203\Term 2\class14\rdd.do"

. 
. *change directory
. cd "$dropbox/TA/EC203/Term 2/class14"
C:\Users\u1972955\Dropbox\TA\EC203\Term 2\class14

. *use data file
. use studentscores, clear

. * open log file 
. cap log using ps14, replace text 

. 
. *ignore the below line (and whenever you see "pause"). This is for me 
. pause on

. 
. 
.   summarize male frlunch black white hispanic asian 

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
        male |      2,727    .4979831    .5000876          0          1
     frlunch |      2,749    .6173154    .4861307          0          1
       black |      2,727    .3370004    .4727717          0          1
       white |      2,727    .3681702    .4823963          0          1
    hispanic |      2,727    .2486249    .4322951          0          1
-------------+---------------------------------------------------------
       asian |      2,727    .0201687    .1406028          0          1

.   *can you interpret the averages?
. qui pause 
pause:  
-> . q
execution resumes...

.   *Try this yourself: On average, what is the difference in scores for those who got tuition vs those
>  who didn't get tuition?
. qui pause
pause:  
-> . q
execution resumes...

.   summarize score_endyr if treat==1, d

         (outcome var.) math test score: end of year
-------------------------------------------------------------
      Percentiles      Smallest
 1%          188            178
 5%          199            180
10%          204            180       Obs               1,295
25%          212            182       Sum of wgt.       1,295

50%          220                      Mean           218.7243
                        Largest       Std. dev.      11.38509
75%          226            251
90%          233            251       Variance       129.6202
95%          236            253       Skewness      -.3299872
99%          244            260       Kurtosis       3.478121

.   summarize score_endyr if treat==0, d

         (outcome var.) math test score: end of year
-------------------------------------------------------------
      Percentiles      Smallest
 1%          197            176
 5%          206            181
10%          211            182       Obs               1,472
25%          218            185       Sum of wgt.       1,472

50%          226                      Mean           225.9158
                        Largest       Std. dev.      12.37494
75%          234            270
90%          242            272       Variance       153.1391
95%          246            274       Skewness       .1214666
99%          257            275       Kurtosis       3.763762

.   ttest score_endyr, by(treat)

Two-sample t test with equal variances
------------------------------------------------------------------------------
   Group |     Obs        Mean    Std. err.   Std. dev.   [95% conf. interval]
---------+--------------------------------------------------------------------
       0 |   1,472    225.9158    .3225441    12.37494    225.2831    226.5485
       1 |   1,295    218.7243    .3163745    11.38509    218.1037     219.345
---------+--------------------------------------------------------------------
Combined |   2,767    222.5501    .2366508    12.44837     222.086    223.0141
---------+--------------------------------------------------------------------
    diff |            7.191437    .4542159                  6.3008    8.082073
------------------------------------------------------------------------------
    diff = mean(0) - mean(1)                                      t =  15.8326
H0: diff = 0                                     Degrees of freedom =     2765

    Ha: diff < 0                 Ha: diff != 0                 Ha: diff > 0
 Pr(T < t) = 1.0000         Pr(|T| > |t|) = 0.0000          Pr(T > t) = 0.0000

.   *is this difference, the causal effect of tuition? Why? Why not?
. qui pause 
pause:  
-> . q
execution resumes...

. 
. * graphical analysis: best place to start with rd designs
.   twoway (scatter score_endyr score_startyr if score_startyr < 215, mcolor(%50)) ///
>   (scatter score_endyr score_startyr if score_startyr >= 215, mcolor(%50)) ///
>   , xline(215) legend(off)

.   
.   *using only information on screen, what quantity on the screen gives us the causal effect?
.   qui pause
pause:  
-> . q
execution resumes...

.   
.   reg score_endyr score_startyr treat

      Source |       SS           df       MS      Number of obs   =     2,767
-------------+----------------------------------   F(2, 2764)      =    966.73
       Model |  176420.833         2  88210.4164   Prob > F        =    0.0000
    Residual |  252203.985     2,764  91.2460147   R-squared       =    0.4116
-------------+----------------------------------   Adj R-squared   =    0.4112
       Total |  428624.817     2,766  154.961973   Root MSE        =    9.5523

-------------------------------------------------------------------------------
  score_endyr | Coefficient  Std. err.      t    P>|t|     [95% conf. interval]
--------------+----------------------------------------------------------------
score_startyr |   .8946397   .0227754    39.28   0.000     .8499812    .9392982
        treat |   10.96764   .5883512    18.64   0.000     9.813988    12.12129
        _cons |   24.74034   5.127495     4.83   0.000     14.68624    34.79445
-------------------------------------------------------------------------------

.   *verify
.   qui pause 
pause:  
-> . q
execution resumes...

.   
.   reg score_endyr treat score_startyr 

      Source |       SS           df       MS      Number of obs   =     2,767
-------------+----------------------------------   F(2, 2764)      =    966.73
       Model |  176420.833         2  88210.4164   Prob > F        =    0.0000
    Residual |  252203.985     2,764  91.2460147   R-squared       =    0.4116
-------------+----------------------------------   Adj R-squared   =    0.4112
       Total |  428624.817     2,766  154.961973   Root MSE        =    9.5523

-------------------------------------------------------------------------------
  score_endyr | Coefficient  Std. err.      t    P>|t|     [95% conf. interval]
--------------+----------------------------------------------------------------
        treat |   10.96764   .5883512    18.64   0.000     9.813988    12.12129
score_startyr |   .8946397   .0227754    39.28   0.000     .8499812    .9392982
        _cons |   24.74034   5.127495     4.83   0.000     14.68624    34.79445
-------------------------------------------------------------------------------

.   predict yhat 
(option xb assumed; fitted values)

.   twoway scatter score_endyr score_startyr || scatter yhat score_startyr, msize(medium) legend(off)

.   
. * balancing tests to check "quasi-randomisation"
. 
.   ttest age, by(treat)

Two-sample t test with equal variances
------------------------------------------------------------------------------
   Group |     Obs        Mean    Std. err.   Std. dev.   [95% conf. interval]
---------+--------------------------------------------------------------------
       0 |   1,449    12.63559     .014213    .5410278    12.60771    12.66347
       1 |   1,274    12.76421    .0177843    .6347787    12.72932     12.7991
---------+--------------------------------------------------------------------
Combined |   2,723    12.69577    .0113094    .5901494    12.67359    12.71794
---------+--------------------------------------------------------------------
    diff |           -.1286171    .0225353                -.172805   -.0844291
------------------------------------------------------------------------------
    diff = mean(0) - mean(1)                                      t =  -5.7074
H0: diff = 0                                     Degrees of freedom =     2721

    Ha: diff < 0                 Ha: diff != 0                 Ha: diff > 0
 Pr(T < t) = 0.0000         Pr(|T| > |t|) = 0.0000          Pr(T > t) = 1.0000

.   ttest age if (score_startyr>=213 & score_startyr<=217), by(treat)

Two-sample t test with equal variances
------------------------------------------------------------------------------
   Group |     Obs        Mean    Std. err.   Std. dev.   [95% conf. interval]
---------+--------------------------------------------------------------------
       0 |     281    12.70922    .0352393    .5907185    12.63985    12.77859
       1 |     170    12.67649    .0474661    .6188821    12.58279    12.77019
---------+--------------------------------------------------------------------
Combined |     451    12.69688    .0283007     .601015    12.64127     12.7525
---------+--------------------------------------------------------------------
    diff |            .0327296    .0584423               -.0821248    .1475841
------------------------------------------------------------------------------
    diff = mean(0) - mean(1)                                      t =   0.5600
H0: diff = 0                                     Degrees of freedom =      449

    Ha: diff < 0                 Ha: diff != 0                 Ha: diff > 0
 Pr(T < t) = 0.7121         Pr(|T| > |t|) = 0.5757          Pr(T > t) = 0.2879

.   
.   ttest male, by(treat)

Two-sample t test with equal variances
------------------------------------------------------------------------------
   Group |     Obs        Mean    Std. err.   Std. dev.   [95% conf. interval]
---------+--------------------------------------------------------------------
       0 |   1,451    .5279118    .0131102    .4993924    .5021949    .5536287
       1 |   1,276    .4639498    .0139664    .4988942    .4365503    .4913494
---------+--------------------------------------------------------------------
Combined |   2,727    .4979831    .0095764    .5000876    .4792053    .5167609
---------+--------------------------------------------------------------------
    diff |            .0639619    .0191568                .0263986    .1015252
------------------------------------------------------------------------------
    diff = mean(0) - mean(1)                                      t =   3.3389
H0: diff = 0                                     Degrees of freedom =     2725

    Ha: diff < 0                 Ha: diff != 0                 Ha: diff > 0
 Pr(T < t) = 0.9996         Pr(|T| > |t|) = 0.0009          Pr(T > t) = 0.0004

.   ttest male if (score_startyr>=213 & score_startyr<=217), by(treat)

Two-sample t test with equal variances
------------------------------------------------------------------------------
   Group |     Obs        Mean    Std. err.   Std. dev.   [95% conf. interval]
---------+--------------------------------------------------------------------
       0 |     282    .4680851    .0297667    .4998675    .4094911    .5266791
       1 |     170    .4588235    .0383309    .4997737    .3831545    .5344926
---------+--------------------------------------------------------------------
Combined |     452    .4646018     .023485     .499298    .4184482    .5107554
---------+--------------------------------------------------------------------
    diff |            .0092616    .0485338               -.0861195    .1046427
------------------------------------------------------------------------------
    diff = mean(0) - mean(1)                                      t =   0.1908
H0: diff = 0                                     Degrees of freedom =      450

    Ha: diff < 0                 Ha: diff != 0                 Ha: diff > 0
 Pr(T < t) = 0.5756         Pr(|T| > |t|) = 0.8487          Pr(T > t) = 0.4244

.  
.   ttest frlunch, by(treat)

Two-sample t test with equal variances
------------------------------------------------------------------------------
   Group |     Obs        Mean    Std. err.   Std. dev.   [95% conf. interval]
---------+--------------------------------------------------------------------
       0 |   1,463    .5399863    .0130348     .498569    .5144175    .5655552
       1 |   1,286    .7052877    .0127183    .4560907    .6803367    .7302387
---------+--------------------------------------------------------------------
Combined |   2,749    .6173154    .0092718    .4861307    .5991349    .6354959
---------+--------------------------------------------------------------------
    diff |           -.1653014    .0183161                -.201216   -.1293868
------------------------------------------------------------------------------
    diff = mean(0) - mean(1)                                      t =  -9.0249
H0: diff = 0                                     Degrees of freedom =     2747

    Ha: diff < 0                 Ha: diff != 0                 Ha: diff > 0
 Pr(T < t) = 0.0000         Pr(|T| > |t|) = 0.0000          Pr(T > t) = 1.0000

.   ttest frlunch if (score_startyr>=213 & score_startyr<=217), by(treat)

Two-sample t test with equal variances
------------------------------------------------------------------------------
   Group |     Obs        Mean    Std. err.   Std. dev.   [95% conf. interval]
---------+--------------------------------------------------------------------
       0 |     287    .6202091    .0286984    .4861825    .5637221     .676696
       1 |     172    .6744186    .0358341    .4699598    .6036845    .7451528
---------+--------------------------------------------------------------------
Combined |     459    .6405229    .0224218    .4803708    .5964605    .6845852
---------+--------------------------------------------------------------------
    diff |           -.0542095    .0463022               -.1452013    .0367822
------------------------------------------------------------------------------
    diff = mean(0) - mean(1)                                      t =  -1.1708
H0: diff = 0                                     Degrees of freedom =      457

    Ha: diff < 0                 Ha: diff != 0                 Ha: diff > 0
 Pr(T < t) = 0.1211         Pr(|T| > |t|) = 0.2423          Pr(T > t) = 0.8789

.   
.   ttest white, by(treat)

Two-sample t test with equal variances
------------------------------------------------------------------------------
   Group |     Obs        Mean    Std. err.   Std. dev.   [95% conf. interval]
---------+--------------------------------------------------------------------
       0 |   1,451    .4362509    .0130235    .4960904     .410704    .4617977
       1 |   1,276    .2907524    .0127176    .4542875    .2658026    .3157021
---------+--------------------------------------------------------------------
Combined |   2,727    .3681702    .0092376    .4823963    .3500566    .3862837
---------+--------------------------------------------------------------------
    diff |            .1454985    .0183059                .1096037    .1813933
------------------------------------------------------------------------------
    diff = mean(0) - mean(1)                                      t =   7.9482
H0: diff = 0                                     Degrees of freedom =     2725

    Ha: diff < 0                 Ha: diff != 0                 Ha: diff > 0
 Pr(T < t) = 1.0000         Pr(|T| > |t|) = 0.0000          Pr(T > t) = 0.0000

.   ttest white if (score_startyr>=213 & score_startyr<=217), by(treat)

Two-sample t test with equal variances
------------------------------------------------------------------------------
   Group |     Obs        Mean    Std. err.   Std. dev.   [95% conf. interval]
---------+--------------------------------------------------------------------
       0 |     282    .3510638    .0284735    .4781514    .2950154    .4071123
       1 |     170    .3882353    .0374884    .4887883    .3142295    .4622411
---------+--------------------------------------------------------------------
Combined |     452    .3650442    .0226702     .481976    .3204918    .4095967
---------+--------------------------------------------------------------------
    diff |           -.0371715    .0468192               -.1291828    .0548399
------------------------------------------------------------------------------
    diff = mean(0) - mean(1)                                      t =  -0.7939
H0: diff = 0                                     Degrees of freedom =      450

    Ha: diff < 0                 Ha: diff != 0                 Ha: diff > 0
 Pr(T < t) = 0.2138         Pr(|T| > |t|) = 0.4277          Pr(T > t) = 0.7862

.   
. * local regression techniques: exploratory analysis 
.   
.   twoway scatter score_endyr score_startyr if score_startyr<215, xline(215) ///
>   msymbol(Oh) msize(vsmall) || scatter score_endyr score_startyr ///
>   if score_startyr>=215, xline(215) msymbol(O) msize(vsmall) ///
>   || lowess score_endyr score_startyr if score_startyr<215 ///
>   || lowess score_endyr score_startyr if score_startyr>=215 

.   
. * placebo analysis 1: 210 cut-off
.   twoway scatter score_endyr score_startyr if score_startyr<210, xline(210) ///
>   msymbol(Oh) msize(vsmall) || scatter score_endyr score_startyr ///
>   if score_startyr>=210, xline(210) msymbol(O) msize(vsmall) ///
>   || lowess score_endyr score_startyr if score_startyr<210 ///
>   || lowess score_endyr score_startyr if score_startyr>=210 

.  
. * placebo analysis 2: 220 cut-off
.   twoway scatter score_endyr score_startyr if score_startyr<220, xline(220) ///
>   msymbol(Oh) msize(vsmall) || scatter score_endyr score_startyr ///
>   if score_startyr>=220, xline(220) msymbol(O) msize(vsmall) ///
>   || lowess score_endyr score_startyr if score_startyr<220 ///
>   || lowess score_endyr score_startyr if score_startyr>=220 

. 
. * fitting a regression to data: 
.   reg score_endyr treat score_startyr 

      Source |       SS           df       MS      Number of obs   =     2,767
-------------+----------------------------------   F(2, 2764)      =    966.73
       Model |  176420.833         2  88210.4164   Prob > F        =    0.0000
    Residual |  252203.985     2,764  91.2460147   R-squared       =    0.4116
-------------+----------------------------------   Adj R-squared   =    0.4112
       Total |  428624.817     2,766  154.961973   Root MSE        =    9.5523

-------------------------------------------------------------------------------
  score_endyr | Coefficient  Std. err.      t    P>|t|     [95% conf. interval]
--------------+----------------------------------------------------------------
        treat |   10.96764   .5883512    18.64   0.000     9.813988    12.12129
score_startyr |   .8946397   .0227754    39.28   0.000     .8499812    .9392982
        _cons |   24.74034   5.127495     4.83   0.000     14.68624    34.79445
-------------------------------------------------------------------------------

.   predict yhat 
variable yhat already defined
r(110);

end of do-file

r(110);

. do "C:\Users\u1972955\AppData\Local\Temp\STD3670_000000.tmp"

.   twoway scatter score_endyr score_startyr || scatter yhat score_startyr, msize(medium) legend(off)

. 
end of do-file

. do "C:\Users\u1972955\AppData\Local\Temp\STD3670_000000.tmp"

.   twoway (scatter score_endyr score_startyr, mcolor(%20))(scatter yhat score_startyr), msize(medium) 
> legend(off)
option msize() not allowed
r(198);

end of do-file

r(198);

. do "C:\Users\u1972955\AppData\Local\Temp\STD3670_000000.tmp"

.   twoway (scatter score_endyr score_startyr, mcolor(%20))(scatter yhat score_startyr, msize(medium)) 
> legend(off)
legend(off) is not a twoway plot type
r(198);

end of do-file

r(198);

. do "C:\Users\u1972955\AppData\Local\Temp\STD3670_000000.tmp"

.   twoway (scatter score_endyr score_startyr, mcolor(%20))(scatter yhat score_startyr, msize(medium)),
>  legend(off)

. 
end of do-file

. do "C:\Users\u1972955\AppData\Local\Temp\STD3670_000000.tmp"

.    twoway (scatter score_endyr score_startyr if black == 0, mcolor(%20)) ///
>    (scatter score_endyr score_startyr if black == 1, mcolor(%20)) ///
>    (scatter yhat score_startyr, msize(medium)), legend(off)

. 
end of do-file

. do "C:\Users\u1972955\AppData\Local\Temp\STD3670_000000.tmp"

.   ttest age, by(treat)

Two-sample t test with equal variances
------------------------------------------------------------------------------
   Group |     Obs        Mean    Std. err.   Std. dev.   [95% conf. interval]
---------+--------------------------------------------------------------------
       0 |   1,449    12.63559     .014213    .5410278    12.60771    12.66347
       1 |   1,274    12.76421    .0177843    .6347787    12.72932     12.7991
---------+--------------------------------------------------------------------
Combined |   2,723    12.69577    .0113094    .5901494    12.67359    12.71794
---------+--------------------------------------------------------------------
    diff |           -.1286171    .0225353                -.172805   -.0844291
------------------------------------------------------------------------------
    diff = mean(0) - mean(1)                                      t =  -5.7074
H0: diff = 0                                     Degrees of freedom =     2721

    Ha: diff < 0                 Ha: diff != 0                 Ha: diff > 0
 Pr(T < t) = 0.0000         Pr(|T| > |t|) = 0.0000          Pr(T > t) = 1.0000

.   ttest age if (score_startyr>=213 & score_startyr<=217), by(treat)

Two-sample t test with equal variances
------------------------------------------------------------------------------
   Group |     Obs        Mean    Std. err.   Std. dev.   [95% conf. interval]
---------+--------------------------------------------------------------------
       0 |     281    12.70922    .0352393    .5907185    12.63985    12.77859
       1 |     170    12.67649    .0474661    .6188821    12.58279    12.77019
---------+--------------------------------------------------------------------
Combined |     451    12.69688    .0283007     .601015    12.64127     12.7525
---------+--------------------------------------------------------------------
    diff |            .0327296    .0584423               -.0821248    .1475841
------------------------------------------------------------------------------
    diff = mean(0) - mean(1)                                      t =   0.5600
H0: diff = 0                                     Degrees of freedom =      449

    Ha: diff < 0                 Ha: diff != 0                 Ha: diff > 0
 Pr(T < t) = 0.7121         Pr(|T| > |t|) = 0.5757          Pr(T > t) = 0.2879

. 
end of do-file

. su age, det

                       age of student
-------------------------------------------------------------
      Percentiles      Smallest
 1%     11.78097       11.32375
 5%     11.96988       11.44969
10%      12.0575       11.47981       Obs               2,723
25%     12.25736        11.5729       Sum of wgt.       2,723

50%      12.6078                      Mean           12.69577
                        Largest       Std. dev.      .5901494
75%     12.96372       15.50445
90%     13.51403        15.6961       Variance       .3482763
95%     13.80424       15.88227       Skewness       1.140427
99%     14.54346       16.07392       Kurtosis       4.969743

. do "C:\Users\u1972955\AppData\Local\Temp\STD3670_000000.tmp"

.   ttest male, by(treat)

Two-sample t test with equal variances
------------------------------------------------------------------------------
   Group |     Obs        Mean    Std. err.   Std. dev.   [95% conf. interval]
---------+--------------------------------------------------------------------
       0 |   1,451    .5279118    .0131102    .4993924    .5021949    .5536287
       1 |   1,276    .4639498    .0139664    .4988942    .4365503    .4913494
---------+--------------------------------------------------------------------
Combined |   2,727    .4979831    .0095764    .5000876    .4792053    .5167609
---------+--------------------------------------------------------------------
    diff |            .0639619    .0191568                .0263986    .1015252
------------------------------------------------------------------------------
    diff = mean(0) - mean(1)                                      t =   3.3389
H0: diff = 0                                     Degrees of freedom =     2725

    Ha: diff < 0                 Ha: diff != 0                 Ha: diff > 0
 Pr(T < t) = 0.9996         Pr(|T| > |t|) = 0.0009          Pr(T > t) = 0.0004

.   ttest male if (score_startyr>=213 & score_startyr<=217), by(treat)

Two-sample t test with equal variances
------------------------------------------------------------------------------
   Group |     Obs        Mean    Std. err.   Std. dev.   [95% conf. interval]
---------+--------------------------------------------------------------------
       0 |     282    .4680851    .0297667    .4998675    .4094911    .5266791
       1 |     170    .4588235    .0383309    .4997737    .3831545    .5344926
---------+--------------------------------------------------------------------
Combined |     452    .4646018     .023485     .499298    .4184482    .5107554
---------+--------------------------------------------------------------------
    diff |            .0092616    .0485338               -.0861195    .1046427
------------------------------------------------------------------------------
    diff = mean(0) - mean(1)                                      t =   0.1908
H0: diff = 0                                     Degrees of freedom =      450

    Ha: diff < 0                 Ha: diff != 0                 Ha: diff > 0
 Pr(T < t) = 0.5756         Pr(|T| > |t|) = 0.8487          Pr(T > t) = 0.4244

. 
end of do-file

. do "C:\Users\u1972955\AppData\Local\Temp\STD3670_000000.tmp"

.   ttest frlunch, by(treat)

Two-sample t test with equal variances
------------------------------------------------------------------------------
   Group |     Obs        Mean    Std. err.   Std. dev.   [95% conf. interval]
---------+--------------------------------------------------------------------
       0 |   1,463    .5399863    .0130348     .498569    .5144175    .5655552
       1 |   1,286    .7052877    .0127183    .4560907    .6803367    .7302387
---------+--------------------------------------------------------------------
Combined |   2,749    .6173154    .0092718    .4861307    .5991349    .6354959
---------+--------------------------------------------------------------------
    diff |           -.1653014    .0183161                -.201216   -.1293868
------------------------------------------------------------------------------
    diff = mean(0) - mean(1)                                      t =  -9.0249
H0: diff = 0                                     Degrees of freedom =     2747

    Ha: diff < 0                 Ha: diff != 0                 Ha: diff > 0
 Pr(T < t) = 0.0000         Pr(|T| > |t|) = 0.0000          Pr(T > t) = 1.0000

.   ttest frlunch if (score_startyr>=213 & score_startyr<=217), by(treat)

Two-sample t test with equal variances
------------------------------------------------------------------------------
   Group |     Obs        Mean    Std. err.   Std. dev.   [95% conf. interval]
---------+--------------------------------------------------------------------
       0 |     287    .6202091    .0286984    .4861825    .5637221     .676696
       1 |     172    .6744186    .0358341    .4699598    .6036845    .7451528
---------+--------------------------------------------------------------------
Combined |     459    .6405229    .0224218    .4803708    .5964605    .6845852
---------+--------------------------------------------------------------------
    diff |           -.0542095    .0463022               -.1452013    .0367822
------------------------------------------------------------------------------
    diff = mean(0) - mean(1)                                      t =  -1.1708
H0: diff = 0                                     Degrees of freedom =      457

    Ha: diff < 0                 Ha: diff != 0                 Ha: diff > 0
 Pr(T < t) = 0.1211         Pr(|T| > |t|) = 0.2423          Pr(T > t) = 0.8789

. 
end of do-file

. do "C:\Users\u1972955\AppData\Local\Temp\STD3670_000000.tmp"

.   ttest white, by(treat)

Two-sample t test with equal variances
------------------------------------------------------------------------------
   Group |     Obs        Mean    Std. err.   Std. dev.   [95% conf. interval]
---------+--------------------------------------------------------------------
       0 |   1,451    .4362509    .0130235    .4960904     .410704    .4617977
       1 |   1,276    .2907524    .0127176    .4542875    .2658026    .3157021
---------+--------------------------------------------------------------------
Combined |   2,727    .3681702    .0092376    .4823963    .3500566    .3862837
---------+--------------------------------------------------------------------
    diff |            .1454985    .0183059                .1096037    .1813933
------------------------------------------------------------------------------
    diff = mean(0) - mean(1)                                      t =   7.9482
H0: diff = 0                                     Degrees of freedom =     2725

    Ha: diff < 0                 Ha: diff != 0                 Ha: diff > 0
 Pr(T < t) = 1.0000         Pr(|T| > |t|) = 0.0000          Pr(T > t) = 0.0000

.   ttest white if (score_startyr>=213 & score_startyr<=217), by(treat)

Two-sample t test with equal variances
------------------------------------------------------------------------------
   Group |     Obs        Mean    Std. err.   Std. dev.   [95% conf. interval]
---------+--------------------------------------------------------------------
       0 |     282    .3510638    .0284735    .4781514    .2950154    .4071123
       1 |     170    .3882353    .0374884    .4887883    .3142295    .4622411
---------+--------------------------------------------------------------------
Combined |     452    .3650442    .0226702     .481976    .3204918    .4095967
---------+--------------------------------------------------------------------
    diff |           -.0371715    .0468192               -.1291828    .0548399
------------------------------------------------------------------------------
    diff = mean(0) - mean(1)                                      t =  -0.7939
H0: diff = 0                                     Degrees of freedom =      450

    Ha: diff < 0                 Ha: diff != 0                 Ha: diff > 0
 Pr(T < t) = 0.2138         Pr(|T| > |t|) = 0.4277          Pr(T > t) = 0.7862

. 
end of do-file

. do "C:\Users\u1972955\AppData\Local\Temp\STD3670_000000.tmp"

.   twoway scatter score_endyr score_startyr if score_startyr<210, xline(210) ///
>   msymbol(Oh) msize(vsmall) || scatter score_endyr score_startyr ///
>   if score_startyr>=210, xline(210) msymbol(O) msize(vsmall) ///
>   || lowess score_endyr score_startyr if score_startyr<210 ///
>   || lowess score_endyr score_startyr if score_startyr>=210 

. 
end of do-file

. do "C:\Users\u1972955\AppData\Local\Temp\STD3670_000000.tmp"

. *let's try polynomial fits  
.   reg score_endyr treat score_startyr score_startyr2 score_startyr3

      Source |       SS           df       MS      Number of obs   =     2,767
-------------+----------------------------------   F(4, 2762)      =    495.97
       Model |  179175.083         4  44793.7707   Prob > F        =    0.0000
    Residual |  249449.735     2,762  90.3148931   R-squared       =    0.4180
-------------+----------------------------------   Adj R-squared   =    0.4172
       Total |  428624.817     2,766  154.961973   Root MSE        =    9.5034

--------------------------------------------------------------------------------
   score_endyr | Coefficient  Std. err.      t    P>|t|     [95% conf. interval]
---------------+----------------------------------------------------------------
         treat |   9.712748   .6917163    14.04   0.000     8.356415    11.06908
 score_startyr |   12.91228   4.921557     2.62   0.009      3.26198    22.56259
score_startyr2 |  -.0596144   .0229303    -2.60   0.009    -.1045767   -.0146521
score_startyr3 |   .0000975   .0000354     2.75   0.006      .000028     .000167
         _cons |  -772.3568   350.1571    -2.21   0.027    -1458.953   -85.76059
--------------------------------------------------------------------------------

.   predict yhat2 
(option xb assumed; fitted values)

.   twoway scatter score_endyr score_startyr if score_startyr<215, xline(215) ///
>   msymbol(Oh) msize(vsmall) || scatter score_endyr score_startyr ///
>   if score_startyr>=215, xline(215) msymbol(O) msize(vsmall) ///
>   || lowess score_endyr score_startyr if score_startyr<215 ///
>   || lowess score_endyr score_startyr if score_startyr>=215 ///
>   || scatter yhat2 score_startyr, msize(medium) 

. 
end of do-file

. do "C:\Users\u1972955\AppData\Local\Temp\STD3670_000000.tmp"

.   reg score_endyr treat score_startyr score_startyr2 score_startyr3

      Source |       SS           df       MS      Number of obs   =     2,767
-------------+----------------------------------   F(4, 2762)      =    495.97
       Model |  179175.083         4  44793.7707   Prob > F        =    0.0000
    Residual |  249449.735     2,762  90.3148931   R-squared       =    0.4180
-------------+----------------------------------   Adj R-squared   =    0.4172
       Total |  428624.817     2,766  154.961973   Root MSE        =    9.5034

--------------------------------------------------------------------------------
   score_endyr | Coefficient  Std. err.      t    P>|t|     [95% conf. interval]
---------------+----------------------------------------------------------------
         treat |   9.712748   .6917163    14.04   0.000     8.356415    11.06908
 score_startyr |   12.91228   4.921557     2.62   0.009      3.26198    22.56259
score_startyr2 |  -.0596144   .0229303    -2.60   0.009    -.1045767   -.0146521
score_startyr3 |   .0000975   .0000354     2.75   0.006      .000028     .000167
         _cons |  -772.3568   350.1571    -2.21   0.027    -1458.953   -85.76059
--------------------------------------------------------------------------------

.   predict yhat2 
variable yhat2 already defined
r(110);

end of do-file

r(110);

. do "C:\Users\u1972955\AppData\Local\Temp\STD3670_000000.tmp"

.   reg score_endyr treat score_startyr score_startyr2 score_startyr3

      Source |       SS           df       MS      Number of obs   =     2,767
-------------+----------------------------------   F(4, 2762)      =    495.97
       Model |  179175.083         4  44793.7707   Prob > F        =    0.0000
    Residual |  249449.735     2,762  90.3148931   R-squared       =    0.4180
-------------+----------------------------------   Adj R-squared   =    0.4172
       Total |  428624.817     2,766  154.961973   Root MSE        =    9.5034

--------------------------------------------------------------------------------
   score_endyr | Coefficient  Std. err.      t    P>|t|     [95% conf. interval]
---------------+----------------------------------------------------------------
         treat |   9.712748   .6917163    14.04   0.000     8.356415    11.06908
 score_startyr |   12.91228   4.921557     2.62   0.009      3.26198    22.56259
score_startyr2 |  -.0596144   .0229303    -2.60   0.009    -.1045767   -.0146521
score_startyr3 |   .0000975   .0000354     2.75   0.006      .000028     .000167
         _cons |  -772.3568   350.1571    -2.21   0.027    -1458.953   -85.76059
--------------------------------------------------------------------------------

.   predict yhat2 
variable yhat2 already defined
r(110);

end of do-file

r(110);

. do "C:\Users\u1972955\AppData\Local\Temp\STD3670_000000.tmp"

.   twoway scatter score_endyr score_startyr if score_startyr<215, xline(215) ///
>   msymbol(Oh) msize(vsmall) || scatter score_endyr score_startyr ///
>   if score_startyr>=215, xline(215) msymbol(O) msize(vsmall) ///
>   || lowess score_endyr score_startyr if score_startyr<215 ///
>   || lowess score_endyr score_startyr if score_startyr>=215 ///
>   || scatter yhat2 score_startyr, msize(medium), legend(off)
variable off not found
r(111);

end of do-file

r(111);

. do "C:\Users\u1972955\AppData\Local\Temp\STD3670_000000.tmp"

.   twoway scatter score_endyr score_startyr if score_startyr<215, xline(215) ///
>   msymbol(Oh) msize(vsmall) || scatter score_endyr score_startyr ///
>   if score_startyr>=215, xline(215) msymbol(O) msize(vsmall) ///
>   || lowess score_endyr score_startyr if score_startyr<215 ///
>   || lowess score_endyr score_startyr if score_startyr>=215 ///
>   || scatter yhat2 score_startyr, msize(medium) legend(off)

. 
end of do-file

. do "C:\Users\u1972955\AppData\Local\Temp\STD3670_000000.tmp"

.   reg score_endyr treat score_startyr_215 score_startyr2_215 score_startyr3_215 ///
>   score_startyr_215_T score_startyr2_215_T score_startyr3_215_T

      Source |       SS           df       MS      Number of obs   =     2,767
-------------+----------------------------------   F(7, 2759)      =    283.74
       Model |   179407.96         7  25629.7086   Prob > F        =    0.0000
    Residual |  249216.857     2,759  90.3286906   R-squared       =    0.4186
-------------+----------------------------------   Adj R-squared   =    0.4171
       Total |  428624.817     2,766  154.961973   Root MSE        =    9.5041

--------------------------------------------------------------------------------------
         score_endyr | Coefficient  Std. err.      t    P>|t|     [95% conf. interval]
---------------------+----------------------------------------------------------------
               treat |   9.612978   1.006135     9.55   0.000     7.640124    11.58583
   score_startyr_215 |   .7413714   .1504189     4.93   0.000     .4464264    1.036316
  score_startyr2_215 |   .0102587   .0100195     1.02   0.306    -.0093879    .0299052
  score_startyr3_215 |  -.0000602   .0001789    -0.34   0.736     -.000411    .0002905
 score_startyr_215_T |   .0988126    .259569     0.38   0.703    -.4101566    .6077818
score_startyr2_215_T |  -.0000886   .0173137    -0.01   0.996    -.0340378    .0338605
score_startyr3_215_T |   .0003366   .0003126     1.08   0.282    -.0002764    .0009496
               _cons |   217.1325   .5864063   370.28   0.000     215.9826    218.2823
--------------------------------------------------------------------------------------

.   predict yhat3 
(option xb assumed; fitted values)

.   twoway scatter score_endyr score_startyr if score_startyr<215, xline(215) ///
>   msymbol(Oh) msize(vsmall) || scatter score_endyr score_startyr ///
>   if score_startyr>=215, xline(215) msymbol(O) msize(vsmall) ///
>   || lowess score_endyr score_startyr if score_startyr<215 ///
>   || lowess score_endyr score_startyr if score_startyr>=215 ///
>   || scatter yhat3 score_startyr, msize(medium) legend(off)

. 
end of do-file

. do "C:\Users\u1972955\AppData\Local\Temp\STD3670_000000.tmp"

.   reg score_endyr treat score_startyr if (score_startyr>=210 & score_s
> tartyr<=220)

      Source |       SS           df       MS      Number of obs   =    
>    936
-------------+----------------------------------   F(2, 933)       =    
>  48.17
       Model |  8683.04222         2  4341.52111   Prob > F        =    
> 0.0000
    Residual |  84085.5732       933  90.1238726   R-squared       =    
> 0.0936
-------------+----------------------------------   Adj R-squared   =    
> 0.0917
       Total |  92768.6154       935  99.2177705   Root MSE        =    
> 9.4934

------------------------------------------------------------------------
> ------
 score_endyr | Coefficient  Std. err.      t    P>|t|     [95% conf. int
> erval]
-------------+----------------------------------------------------------
> ------
       treat |   10.41945   1.185958     8.79   0.000     8.091995     1
> 2.7469
score_star~r |    .988541   .1914137     5.16   0.000     .6128898    1.
> 364192
       _cons |   3.995882   41.59737     0.10   0.923    -77.63938    85
> .63114
------------------------------------------------------------------------
> ------

.   reg score_endyr treat score_startyr if (score_startyr>=212 & score_s
> tartyr<=218)

      Source |       SS           df       MS      Number of obs   =    
>    622
-------------+----------------------------------   F(2, 619)       =    
>  45.87
       Model |  8149.59119         2  4074.79559   Prob > F        =    
> 0.0000
    Residual |  54992.1773       619  88.8403511   R-squared       =    
> 0.1291
-------------+----------------------------------   Adj R-squared   =    
> 0.1263
       Total |  63141.7685       621  101.677566   Root MSE        =    
> 9.4255

------------------------------------------------------------------------
> ------
 score_endyr | Coefficient  Std. err.      t    P>|t|     [95% conf. int
> erval]
-------------+----------------------------------------------------------
> ------
       treat |   9.655931    1.46731     6.58   0.000     6.774423    12
> .53744
score_star~r |   .7366842   .3742249     1.97   0.049     .0017799    1.
> 471589
       _cons |   58.62407   80.96635     0.72   0.469     -100.378    21
> 7.6261
------------------------------------------------------------------------
> ------

.   reg score_endyr treat score_startyr if (score_startyr>=214 & score_s
> tartyr<=216)

      Source |       SS           df       MS      Number of obs   =    
>    291
-------------+----------------------------------   F(2, 288)       =    
>  29.81
       Model |  5507.42216         2  2753.71108   Prob > F        =    
> 0.0000
    Residual |  26602.7497       288  92.3706585   R-squared       =    
> 0.1715
-------------+----------------------------------   Adj R-squared   =    
> 0.1658
       Total |  32110.1718       290   110.72473   Root MSE        =    
>  9.611

------------------------------------------------------------------------
> ------
 score_endyr | Coefficient  Std. err.      t    P>|t|     [95% conf. int
> erval]
-------------+----------------------------------------------------------
> ------
       treat |   8.126958   2.319993     3.50   0.001     3.560667    12
> .69325
score_star~r |  -.9011947   1.355063    -0.67   0.507    -3.568278    1.
> 765889
       _cons |   411.6037   291.9535     1.41   0.160    -163.0295    98
> 6.2369
------------------------------------------------------------------------
> ------

. 
end of do-file

. do "C:\Users\u1972955\AppData\Local\Temp\STD3670_000000.tmp"

. * equivalent placebo tests using placebo treatments
. 
.   reg score_endyr plabo_treat1 score_startyr score_startyr2 score_star
> tyr3

      Source |       SS           df       MS      Number of obs   =    
>  2,767
-------------+----------------------------------   F(4, 2762)      =    
> 421.53
       Model |  162476.024         4   40619.006   Prob > F        =    
> 0.0000
    Residual |  266148.793     2,762  96.3608955   R-squared       =    
> 0.3791
-------------+----------------------------------   Adj R-squared   =    
> 0.3782
       Total |  428624.817     2,766  154.961973   Root MSE        =    
> 9.8164

------------------------------------------------------------------------
> ------
 score_endyr | Coefficient  Std. err.      t    P>|t|     [95% conf. int
> erval]
-------------+----------------------------------------------------------
> ------
plabo_treat1 |   2.475684     .73015     3.39   0.001     1.043989    3.
> 907379
score_star~r |   42.84441   4.682045     9.15   0.000     33.66374    52
> .02507
score_star~2 |   -.199684   .0218892    -9.12   0.000    -.2426049   -.1
> 567631
score_star~3 |   .0003135    .000034     9.23   0.000     .0002469    .0
> 003801
       _cons |  -2875.724    332.438    -8.65   0.000    -3527.577   -22
> 23.872
------------------------------------------------------------------------
> ------

.   reg score_endyr plabo_treat2 score_startyr score_startyr2 score_star
> tyr3

      Source |       SS           df       MS      Number of obs   =    
>  2,767
-------------+----------------------------------   F(4, 2762)      =    
> 417.12
       Model |  161417.534         4  40354.3835   Prob > F        =    
> 0.0000
    Residual |  267207.284     2,762  96.7441288   R-squared       =    
> 0.3766
-------------+----------------------------------   Adj R-squared   =    
> 0.3757
       Total |  428624.817     2,766  154.961973   Root MSE        =    
> 9.8359

------------------------------------------------------------------------
> ------
 score_endyr | Coefficient  Std. err.      t    P>|t|     [95% conf. int
> erval]
-------------+----------------------------------------------------------
> ------
plabo_treat2 |  -.5190429   .7269194    -0.71   0.475    -1.944403    .9
> 063175
score_star~r |   46.89794   5.063689     9.26   0.000     36.96894    56
> .82694
score_star~2 |  -.2200947   .0234387    -9.39   0.000    -.2660539   -.1
> 741356
score_star~3 |    .000347    .000036     9.64   0.000     .0002765    .0
> 004176
       _cons |  -3136.245   362.9571    -8.64   0.000     -3847.94    -2
> 424.55
------------------------------------------------------------------------
> ------

. 
end of do-file

. exit, clear
